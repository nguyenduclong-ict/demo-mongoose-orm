(window.webpackJsonp=window.webpackJsonp||[]).push([[18,7,19],{799:function(e,t,n){"use strict";var l=n(22);n.d(t,"a",(function(){return l}));var o=n(114);n.d(t,"b",(function(){return o}))},801:function(e,t,n){"use strict";n.r(t);n(20),n(12),n(25),n(38),n(39);var l=n(7),o=n(8),r=n(295),c=(n(63),n(471),n(13),n(113),n(294),n(199),n(81),n(472),n(804)),d=n(802),f=n(76),h=n(799);function v(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function y(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?v(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):v(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m={name:"SelectEntity",components:{SelectEntityOption:c.default,CustomElSelect:d.default},props:{value:{type:[String,Number,Array,Object]},service:{type:f.b},defaultOptions:{type:Array,default:function(){return[]}},method:{type:String,default:"list"},payload:{type:Object,default:function(){return{query:{},search:"",page:1,pageSize:10,total:0,exact:!0}}},selectProps:{type:Object,default:function(){return{}}},valueKey:{type:String,default:"id"},labelKey:{type:String,default:"name"},limit:{type:Number,default:1},crud:{type:Object,default:function(){return{create:!1,edit:!1,delete:!1}}},transform:{type:[Object,String],validator:function(e){console.log(e)}},filterDataMethod:{type:Function},clearable:{type:Boolean,default:!0}},data:function(){return{data:[],fetching:!1,selectedValues:[],selectedOptions:[],oldSelectedValues:[]}},computed:{_value:{get:function(){var e;return null!==(e=this.transform)&&void 0!==e&&e.get?this.transform.get(this.value,this):this.value},set:function(e){var t;if(null!==(t=this.transform)&&void 0!==t&&t.set)return this.$emit("input",this.transform.set(e,this));this.$emit("input",e||null)}},listOptions:function(){var e,t=this,map={},data=[];return(e=this.defaultOptions||[]).concat.apply(e,Object(r.a)(this.selectedOptions).concat(Object(r.a)(this.data))).forEach((function(e){return h.b.pushIfNotExists(data,map,e,t.valueKey)})),this.filterDataMethod&&(data=this.filterDataMethod(data,this)),data},multiple:function(){return this.limit>1},setting:function(){return Object.assign({},this.selectProps)}},watch:{_value:{handler:function(e){var t=this;if(this.selectedValues.splice(0),e){e=Array.isArray(e)?e:[e];var map={};e.forEach((function(e){var n=t.listOptions.find((function(n){return h.a.get(n,t.valueKey)===e}));n&&h.b.pushIfNotExists(t.selectedValues,map,n,"id")}))}}}},created:function(){this.mapDefaultValue(),this.fetchData()},methods:{handleCreate:function(text,option){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,l,o,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("create",text),n=e.crud.create.service||e.service,l=e.crud.create.method||"create",o=n[l],r=y({data:{}},e.crud.create.payload||{}),h.a.set(r.data,e.crud.create.field||"name",text),t.next=9,o.call(n,e.$axios,r);case 9:c=t.sent,e.data.unshift(c),e.$nextTick((function(){e.$refs.select.selectOptionByValue(c.id)})),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),console.log("create new item error");case 17:case"end":return t.stop()}}),t,null,[[0,14]])})))()},handleChange:function(e){this.$emit("change",e)},filterMethod:function(text){this.payload.search=text,this.fetchData()},mapDefaultValue:function(){this.selectedValues=[],this.defaultChecked&&(this.limit>1?this.selectedValues=this.defaultChecked:this.selectedValues.push(this.defaultChecked)),this.oldSelectedValues=Object(r.a)(this.selectedValues)},fetchData:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,l,o,c,d,data,f,v,m,_,O,k;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.service){t.next=3;break}return console.warn("select-entity no service"),t.abrupt("return");case 3:return e.fetching=!0,t.prev=4,l=y({page:1,pageSize:10,exact:!0},l=h.a.pick(e.payload,["query","page","pageSize","search","exact","populates","sort","select"])),t.next=9,e.service[e.method](e.$axios,l);case 9:o=t.sent,c=h.b.santizeResponse(o),d=c.data,data=void 0===d?[]:d,f=c.page,v=void 0===f?1:f,m=c.pageSize,_=void 0===m?10:m,O=c.total,k=void 0===O?0:O,(n=e.data).splice.apply(n,[0,e.data.length].concat(Object(r.a)(data))),e.payload.page=v,e.payload.pageSize=_,e.payload.total=k,t.next=20;break;case 17:t.prev=17,t.t0=t.catch(4),console.log("DataTable fetch data error",t.t0);case 20:e.fetching=!1;case 21:case"end":return t.stop()}}),t,null,[[4,17]])})))()}}},_=n(4),component=Object(_.a)(m,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("CustomElSelect",e._b({ref:"select",attrs:{filterable:"",clearable:e.clearable,"filter-method":e.filterMethod,multiple:e.limit>1,"multiple-limit":e.limit,loading:e.fetching,"allow-create":!!e.crud.create,"default-first-option":!!e.crud.create},on:{change:e.handleChange,create:e.handleCreate},model:{value:e._value,callback:function(t){e._value=t},expression:"_value"}},"CustomElSelect",e.setting,!1),e._l(e.listOptions,(function(t,l){return n("SelectEntityOption",{key:e._.get(t,e.valueKey)||t.id||l,attrs:{value:e._.get(t,e.valueKey),label:e._.get(t,e.labelKey)}},[e._t("item",null,{item:t,context:this})],2)})),1)}),[],!1,null,"7d0a462f",null);t.default=component.exports;installComponents(component,{SelectEntityOption:n(804).default,CustomElSelect:n(802).default})},802:function(e,t,n){"use strict";n.r(t);n(64),n(294),n(199);var l={extends:n(34).Select,methods:{handleOptionSelect:function(option,e){var t=this;if(this.multiple){var n=(this.value||[]).slice(),l=this.getValueIndex(n,option.value);l>-1?n.splice(l,1):(this.multipleLimit<=0||n.length<this.multipleLimit)&&n.push(option.value),this.$emit("input",n),this.emitChange(n),option.created&&(this.query="",this.handleQueryChange(""),this.inputLength=20),this.filterable&&this.$refs.input.focus()}else option.created&&(this.query="",this.handleQueryChange(""),this.inputLength=20),this.$emit("input",option.value),this.emitChange(option.value),this.visible=!1;this.isSilentBlur=e,this.setSoftFocus(),this.visible||this.$nextTick((function(){t.scrollToOption(option)}))},selectOption:function(){this.visible?this.options[this.hoverIndex]&&(this.options[this.hoverIndex].created&&this.$emit("create",this.query,this.options[this.hoverIndex]),this.handleOptionSelect(this.options[this.hoverIndex])):this.toggleMenu()},selectOptionByValue:function(e){var option=this.cachedOptions.find((function(option){return option.value===e}));option&&this.handleOptionSelect(option)}}},o=n(4),component=Object(o.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleClose,expression:"handleClose"}],staticClass:"el-select",class:[e.selectSize?"el-select--"+e.selectSize:""],on:{click:function(t){return t.stopPropagation(),e.toggleMenu(t)}}},[e.multiple?n("div",{ref:"tags",staticClass:"el-select__tags",style:{"max-width":e.inputWidth-32+"px",width:"100%"}},[e.collapseTags&&e.selected.length?n("span",[n("el-tag",{attrs:{closable:!e.selectDisabled,size:e.collapseTagSize,hit:e.selected[0].hitState,type:"info","disable-transitions":""},on:{close:function(t){return e.deleteTag(t,e.selected[0])}}},[n("span",{staticClass:"el-select__tags-text"},[e._v("\n          "+e._s(e.selected[0].currentLabel)+"\n        ")])]),e._v(" "),e.selected.length>1?n("el-tag",{attrs:{closable:!1,size:e.collapseTagSize,type:"info","disable-transitions":""}},[n("span",{staticClass:"el-select__tags-text"},[e._v("+ "+e._s(e.selected.length-1))])]):e._e()],1):e._e(),e._v(" "),e.collapseTags?e._e():n("transition-group",{on:{"after-leave":e.resetInputHeight}},e._l(e.selected,(function(t){return n("el-tag",{key:e.getValueKey(t),attrs:{closable:!e.selectDisabled,size:e.collapseTagSize,hit:t.hitState,type:"info","disable-transitions":""},on:{close:function(n){return e.deleteTag(n,t)}}},[n("span",{staticClass:"el-select__tags-text"},[e._v(e._s(t.currentLabel))])])})),1),e._v(" "),e.filterable?n("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],ref:"input",staticClass:"el-select__input",class:[e.selectSize?"is-"+e.selectSize:""],style:{"flex-grow":"1",width:e.inputLength/(e.inputWidth-32)+"%","max-width":e.inputWidth-42+"px"},attrs:{type:"text",disabled:e.selectDisabled,autocomplete:e.autoComplete||e.autocomplete},domProps:{value:e.query},on:{focus:e.handleFocus,blur:function(t){e.softFocus=!1},keyup:e.managePlaceholder,keydown:[e.resetInputState,function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.preventDefault(),e.navigateOptions("next"))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.preventDefault(),e.navigateOptions("prev"))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.selectOption(t))},function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;t.stopPropagation(),t.preventDefault(),e.visible=!1},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.deletePrevTag(t)},function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab"))return null;e.visible=!1}],compositionstart:e.handleComposition,compositionupdate:e.handleComposition,compositionend:e.handleComposition,input:[function(t){t.target.composing||(e.query=t.target.value)},e.debouncedQueryChange]}}):e._e()],1):e._e(),e._v(" "),n("el-input",{ref:"reference",class:{"is-focus":e.visible},attrs:{id:e.id,type:"text",placeholder:e.currentPlaceholder,name:e.name,autocomplete:e.autoComplete||e.autocomplete,size:e.selectSize,disabled:e.selectDisabled,readonly:e.readonly,"validate-event":!1,tabindex:e.multiple&&e.filterable?"-1":null},on:{focus:e.handleFocus,blur:e.handleBlur},nativeOn:{keyup:function(t){return e.debouncedOnInputChange(t)},keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:(t.stopPropagation(),t.preventDefault(),e.navigateOptions("next"))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:(t.stopPropagation(),t.preventDefault(),e.navigateOptions("prev"))},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),e.selectOption(t))},function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"]))return null;t.stopPropagation(),t.preventDefault(),e.visible=!1},function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab"))return null;e.visible=!1}],paste:function(t){return e.debouncedOnInputChange(t)},mouseenter:function(t){e.inputHovering=!0},mouseleave:function(t){e.inputHovering=!1}},model:{value:e.selectedLabel,callback:function(t){e.selectedLabel=t},expression:"selectedLabel"}},[e.$slots.prefix?n("template",{slot:"prefix"},[e._t("prefix")],2):e._e(),e._v(" "),n("template",{slot:"suffix"},[n("i",{directives:[{name:"show",rawName:"v-show",value:!e.showClose,expression:"!showClose"}],class:["el-select__caret","el-input__icon","el-icon-"+e.iconClass]}),e._v(" "),e.showClose?n("i",{staticClass:"el-select__caret el-input__icon el-icon-circle-close",on:{click:e.handleClearClick}}):e._e()])],2),e._v(" "),n("transition",{attrs:{name:"el-zoom-in-top"},on:{"before-enter":e.handleMenuEnter,"after-leave":e.doDestroy}},[n("el-select-menu",{directives:[{name:"show",rawName:"v-show",value:e.visible&&!1!==e.emptyText,expression:"visible && emptyText !== false"}],ref:"popper",attrs:{"append-to-body":e.popperAppendToBody}},[n("el-scrollbar",{directives:[{name:"show",rawName:"v-show",value:e.options.length>0&&!e.loading,expression:"options.length > 0 && !loading"}],ref:"scrollbar",class:{"is-empty":!e.allowCreate&&e.query&&0===e.filteredOptionsCount},attrs:{tag:"ul","wrap-class":"el-select-dropdown__wrap","view-class":"el-select-dropdown__list"}},[e.showNewOption?n("el-option",{attrs:{value:e.query,created:""}},[n("icon",{attrs:{name:"el-icon-plus"}}),e._v("\n          "+e._s(e.query)+"\n        ")],1):e._e(),e._v(" "),e._t("default")],2),e._v(" "),e.emptyText&&(!e.allowCreate||e.loading||e.allowCreate&&0===e.options.length)?[e.$slots.empty?e._t("empty"):n("p",{staticClass:"el-select-dropdown__empty"},[e._v("\n          "+e._s(e.emptyText)+"\n        ")])]:e._e()],2)],1)],1)}),[],!1,null,"2ed420cc",null);t.default=component.exports;installComponents(component,{Icon:n(198).default})},804:function(e,t,n){"use strict";n.r(t);var l={extends:n(34).Option},o=n(4),component=Object(o.a)(l,undefined,undefined,!1,null,"0f4d31b3",null);t.default=component.exports}}]);